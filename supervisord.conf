[supervisord]
nodaemon=true
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[program:fastapi]
command=uvicorn api.main:app --host 0.0.0.0 --port 8080
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/fastapi.err.log
stdout_logfile=/var/log/supervisor/fastapi.out.log
environment=AWS_ACCESS_KEY_ID="%(ENV_AWS_ACCESS_KEY_ID)s",AWS_SECRET_ACCESS_KEY="%(ENV_AWS_SECRET_ACCESS_KEY)s",AWS_REGION="%(ENV_AWS_REGION)s",OPENAI_API_KEY="%(ENV_OPENAI_API_KEY)s",PINECONE_API_KEY="%(ENV_PINECONE_API_KEY)s",PINECONE_ENVIRONMENT="%(ENV_PINECONE_ENVIRONMENT)s",DYNAMODB_TABLE_NAME="%(ENV_DYNAMODB_TABLE_NAME)s"

[program:dynamodb-mcp]
command=uv run awslabs.dynamodb-mcp-server --table_name %(ENV_DYNAMODB_TABLE_NAME)s --region %(ENV_AWS_REGION)s
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/dynamodb-mcp.err.log
stdout_logfile=/var/log/supervisor/dynamodb-mcp.out.log
environment=AWS_ACCESS_KEY_ID="%(ENV_AWS_ACCESS_KEY_ID)s",AWS_SECRET_ACCESS_KEY="%(ENV_AWS_SECRET_ACCESS_KEY)s",AWS_REGION="%(ENV_AWS_REGION)s"

[program:postgres-mcp]
command=uv run awslabs.postgres-mcp-server --database %(ENV_POSTGRES_DB)s --region %(ENV_AWS_REGION)s
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/postgres-mcp.err.log
stdout_logfile=/var/log/supervisor/postgres-mcp.out.log
environment=AWS_ACCESS_KEY_ID="%(ENV_AWS_ACCESS_KEY_ID)s",AWS_SECRET_ACCESS_KEY="%(ENV_AWS_SECRET_ACCESS_KEY)s",AWS_REGION="%(ENV_AWS_REGION)s",FOOD_DB_ARN="%(ENV_FOOD_DB_ARN)s",FOOD_DB_SECRET="%(ENV_FOOD_DB_SECRET)s",FOOD_DB_NAME="%(ENV_FOOD_DB_NAME)s",FOOD_DB_READONLY="%(ENV_FOOD_DB_READONLY)s"
